{% extends "layout.html.twig" %}

{% block content %}

    <noscript>You must <a href="http://www.enable-javascript.com" target="_blank">Activez JavaScript</a> pour pouvoir payer votre commande avec notre partenaire Stripe !</noscript>
    <script src="https://checkout.stripe.com/checkout.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.js"></script>
	 <!-- Page Tittle Start -->
        <section class="page-tittle page-tittle-md bg dark-overlay" style="background-image: url({{ asset('images/cv-preparation-rendez-vous.jpg') }}">
            <div class="container">
                <div class="page-tittle-head display-block text-center">
                    <h1><small>Etape 4 : </small>Finalisation de votre commande</h1>
                </div>
            </div>
        </section>
        <!-- Page Tittle End -->

        <!-- Form wizard -->
        <div class="container">
            <div class="row">
                <section>
                <div class="wizard">
                    <div class="wizard-inner">
                        <div class="connecting-line"></div>
                        <ul class="nav nav-tabs" role="tablist">

                            <li role="presentation">
                                <a href="{{ path('pimpit') }}" aria-controls="step1" role="tab" title="Etape 1 : Informations générales">
                                    <span class="round-tab">
                                        <i class="glyphicon glyphicon-folder-open"></i>
                                    </span>
                                </a>
                            </li>

                            <li role="presentation">
                                <a href="{{ path('cv') }}" aria-controls="step2" role="tab" title="Etape 2 : Contenu de votre CV">
                                    <span class="round-tab">
                                        <i class="glyphicon glyphicon-pencil"></i>
                                    </span>
                                </a>
                            </li>
                            <li role="presentation">
                                <a href="{{ path('template_options') }}" aria-controls="step3" role="tab" title="Etape 3 : Template et options">
                                    <span class="round-tab">
                                        <i class="glyphicon glyphicon-picture"></i>
                                    </span>
                                </a>
                            </li>

                            <li role="presentation" class="active">
                                <a href="#complete" data-toggle="tab" aria-controls="complete" role="tab" title="Etape 4 : Finalisation">
                                    <span class="round-tab">
                                        <i class="glyphicon glyphicon-ok"></i>
                                    </span>
                                </a>
                            </li>
                        </ul>
                    </div>

                    <div class="tab-pane active" role="tabpanel" id="step2">
                    <div class="row">


                        <h3 class="mrg-btm-30">Résumé de votre commande :</h3>
                        <div class="card pdd-horizon-30 pdd-vertical-50 mrg-top-30">
                            <div class="">
                                <p>Numéro de votre commande: <span class="pull-right">{{ commande.Id }}</span></p>
                                <p>Date de votre commande: <span class="pull-right"> {{ commande.dateCommande}} </span></p>
                                <p>Statut de votre commande <span class="pull-right">{{ commande.statutCommande }} </span></p>

                            </div>

                        </div>

                    </div>

                    <div class="row">

                        <h3 class="mrg-btm-30">Paiement de votre commande :</h3>
                        <div class="card padding-30">
                            <div class="row border bottom pdd-btm-20">
                                <div class="col-md-9">
                                    <div class="radio mrg-btm-10">
                                        <input type="radio" name="group1" id="radio2" checked="">
                                        <label for="radio2"><span class="lh-0 font-size-22 pdd-left-10 ls-0-5"><b>Carte de Credit</b></span></label>
                                    </div>
                                    <p class="pdd-left-40 width-90">Module de notre partenaire de paiement Stripe, sécurisé par SSL. <br />Cartes acceptées : Visa, MasterCard.</p>
                                </div>
                                <div class="col-md-3">
                                    <img class="img-responsive mrg-top-30" src="assets/images/thumb/credit-card.png" alt="">
                                </div>
                            </div>
                            <div class="pricing-footer">
                                <form action="{{ path('validationStandard') }}" method="post">


                                        <input
                                            type="submit"
                                            value="Valider ma commande"
                                            data-key="{{stripe['publishable_key']}}"
                                            data-email="{{email}}"
                                            data-image="https://stripe.com/img/documentation/checkout/marketplace.png"
                                            data-amount="10000"
                                            data-currency="eur"
                                            data-name="PimpMyCV"
                                            data-description="Commande {{ commande.Id }}"
                                            data-locale="auto"
                                            data-allow-remember-me="false"
                                            class="btn btn-block btn-dark no-mrg-btm"
                                        />

                                        <script>
                                        $(document).ready(function() {
                                            $(':submit').on('click', function(event) {
                                                event.preventDefault();
                                                var $button = $(this),
                                                    $form = $button.parents('form');
                                                var opts = $.extend({}, $button.data(), {
                                                    token: function(result) {
                                                        $form.append($('<input>').attr({ type: 'hidden', name: 'stripeToken', value: result.id })).submit();
                                                    }
                                                });
                                                StripeCheckout.open(opts);
                                            });
                                        });
                                        </script>
                                </form>
                            </div>
                        </div>

                    </div>


                <!-- Cart Start -->
                <section class="section-6">

                    <div class="row mrg-top-50">
                        <ul class="list-inline pull-right">
                            <li><a href="{{ path('template_options') }}"><button type="button" class="btn btn-default prev-step">Etape précédente</button></a></li>
                        </ul>
                    </div>

                </section>

            </section>

        <!-- Cart End -->



    {% endblock %}
